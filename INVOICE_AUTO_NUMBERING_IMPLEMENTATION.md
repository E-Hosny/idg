# ุชุทุจูู ูุธุงู ุงูุชุฑููู ุงูุชููุงุฆู ููููุงุชูุฑ - ูููุฏ ููุท

## ุงูููุฎุต
ุชู ุชุทุจูู ูุธุงู ุชุฑููู ุชููุงุฆู ููููุงุชูุฑ ุจุตูุบุฉ `INVXXXX` ุจูุฌุงุญุ ุญูุซ ูุชู ุฅูุดุงุก ุฑูู ุงููุงุชูุฑุฉ ุชููุงุฆูุงู ุจูุงุกู ุนูู ุงูููุงุชูุฑ ุงูููุฌูุฏุฉ ูู ูููุฏ ูุถูุงู ุงูุชุณูุณู ุงูุตุญูุญ ุนุจุฑ ุฌููุน ุงูุจูุฆุงุช.

## ุงูุชุบููุฑุงุช ุงููููุฐุฉ

### 1. โ ุชุญุฏูุซ ุฎุฏูุฉ ูููุฏ (QoyodService)
- **ููู**: `app/Services/QoyodService.php`
- **ุงูุฏุงูุฉ ุงูุฌุฏูุฏุฉ**: `generateNextInvoiceNumber()`
- **ุงูุขููุฉ**:
  - ุฌูุจ ุฌููุน ุงูููุงุชูุฑ ูู ูููุฏ
  - ุงูุจุญุซ ุนู ุฃุนูู ุฑูู ูุงุชูุฑุฉ ุจุตูุบุฉ INVXXXX
  - ุชูููุฏ ุงูุฑูู ุงูุชุงูู ูู ุงูุชุณูุณู
  - ุงูุชุนุงูู ูุน ุญุงูุงุช ุงููุดู (fallback mechanism)

### 2. โ ุญุฐู ุงููุธุงู ุงููุญูู
- **ุชู ุญุฐู**: `app/Models/InvoiceNumber.php`
- **ุชู ุญุฐู**: ุฌุฏูู `invoice_numbers` ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- **ุงูุณุจุจ**: ุชุฌูุจ ูุดุงูู ุงูุชุฒุงูู ุจูู ุงูุจูุฆุงุช ุงููุฎุชููุฉ

### 3. โ ุชุญุฏูุซ ุงููุชุญูู (Controller)
- **ููู**: `app/Http/Controllers/DashboardController.php`
- **ุงูุชุญุฏูุซ ูู**: method `storeInvoice()`
- **ุงูุชุบููุฑุงุช**:
  - ุฅุฒุงูุฉ ุงูุงุนุชูุงุฏ ุนูู ุงููููุฐุฌ ุงููุญูู
  - ุงูุณูุงุญ ูุฎุฏูุฉ ูููุฏ ุจุชูููุฏ ุงูุฑูู ุชููุงุฆูุงู
  - ุงูุชูุธูู: ุฅุฒุงูุฉ `reference` ูู ุงูุจูุงูุงุช ุงููุฑุณูุฉ

### 4. ุชุญุฏูุซ ุงููุงุฌูุฉ ุงูุฃูุงููุฉ
- **ููู**: `resources/js/Pages/Dashboard/Customers/CreateInvoice.vue`
- **ุงูุชุบููุฑุงุช**:
  - ุฅุฒุงูุฉ ุญูู ุฅุฏุฎุงู ุฑูู ุงููุงุชูุฑุฉ
  - ุนุฑุถ ุฑุณุงูุฉ ุชูุถูุญูุฉ: "ุณูุชู ุฅูุดุงุคู ุชููุงุฆูุงู (INVXXXX)"
  - ุฅุฒุงูุฉ ุฏุงูุฉ `generateReferenceNumber()`
  - ุฅุถุงูุฉ ุงููุตูุต ุจุงููุบุชูู ุงูุนุฑุจูุฉ ูุงูุฅูุฌููุฒูุฉ

## ููููุฉ ุนูู ุงููุธุงู ุงูุฌุฏูุฏ

1. **ุนูุฏ ุฅูุดุงุก ูุงุชูุฑุฉ ุฌุฏูุฏุฉ**:
   - ูุณุชุฏุนู ุงููุธุงู `QoyodService->generateNextInvoiceNumber()`
   - ูุฌูุจ ุฌููุน ุงูููุงุชูุฑ ูู ูููุฏ API
   - ูุจุญุซ ุนู ุฃุนูู ุฑูู ูุงุชูุฑุฉ ุจุตูุบุฉ INVXXXX
   - ูููุฏ ุงูุฑูู ุงูุชุงูู ูู ุงูุชุณูุณู
   - ูุฑุณู ุงููุงุชูุฑุฉ ูุน ุงูุฑูู ุงููููุฏ ุฅูู ูููุฏ

2. **ุงูุฃูุงู ูุงูุชุณูุณู**:
   - **ุงููุตุฏุฑ ุงููุญูุฏ ููุญูููุฉ**: ูููุฏ API
   - **ูุง ุชูุฌุฏ ูุดุงูู ุชุฒุงูู**: ุงููุธุงู ูุนุชูุฏ ุนูู ูููุฏ ููุท
   - **ูุนูู ุนุจุฑ ุฌููุน ุงูุจูุฆุงุช**: ูุญููุ ุณูุฑูุฑุ ุชุทููุฑุ ุฅูุชุงุฌ

3. **ุตูุบุฉ ุงูุชุฑููู**:
   - ุงูุจุงุฏุฆุฉ: INV
   - ุงูุฃุฑูุงู: ูุจุทูุฉ ุจุฃุตูุงุฑ ุฅูู 4 ุฎุงูุงุช
   - ูุซุงู: INV0001, INV0002, INV0003, ...
   - **Fallback**: ูู ุญุงูุฉ ูุดู ูููุฏุ ูุณุชุฎุฏู timestamp

4. **ูุฒุงูุง ุงููุธุงู ุงูุฌุฏูุฏ**:
   - โ **ุชุณูุณู ูุชุณู** ุนุจุฑ ุฌููุน ุงูุจูุฆุงุช
   - โ **ูุง ุชูุฌุฏ ุฃุฑูุงู ููุฑุฑุฉ** ุจูู ุงูุจูุฆุงุช ุงููุฎุชููุฉ
   - โ **ูุตุฏุฑ ูุงุญุฏ ููุซูู** (ูููุฏ)
   - โ **ุณูููุฉ ุงูุตูุงูุฉ** ูุนุฏู ูุฌูุฏ ุฌุฏุงูู ุฅุถุงููุฉ

## ุงูุงุฎุชุจุงุฑ
ุชู ุงุฎุชุจุงุฑ ุงููุธุงู ุงูุฌุฏูุฏ ูุชุฃููุฏ ุนููู ุจุดูู ุตุญูุญ:
```bash
php artisan tinker --execute="echo (new App\Services\QoyodService())->generateNextInvoiceNumber();"
# ุงููุชูุฌุฉ: INV0005 (ุจูุงุกู ุนูู ุงูููุงุชูุฑ ุงูููุฌูุฏุฉ ูู ูููุฏ)
```

### ุงุฎุชุจุงุฑ ุงูุชูุงูู ุงููุงูู:
- โ ุฌูุจ ุงูููุงุชูุฑ ูู ูููุฏ
- โ ุชุญููู ุฃุฑูุงู ุงูููุงุชูุฑ ุงูููุฌูุฏุฉ
- โ ุชูููุฏ ุงูุฑูู ุงูุชุงูู ุจุตูุบุฉ INVXXXX
- โ ุฅุฑุณุงู ุงููุงุชูุฑุฉ ุงูุฌุฏูุฏุฉ ุฅูู ูููุฏ

## ุงูููุงุญุธุงุช ุงููููุฉ

### โ ูุฒุงูุง ุงููุธุงู ุงูุฌุฏูุฏ:
- **ุชุณูุณู ููุญุฏ**: ุงููุธุงู ูุนุชูุฏ ุนูู ูููุฏ ููุทุ ูุง ุชูุฌุฏ ูุดุงูู ุชุฒุงูู
- **ูุนูู ุนุจุฑ ุฌููุน ุงูุจูุฆุงุช**: ูุญููุ ุณูุฑูุฑุ ุชุทููุฑุ ุฅูุชุงุฌ
- **ูุง ุชูุฌุฏ ุฃุฑูุงู ููุฑุฑุฉ**: ุงููุตุฏุฑ ุงููุญูุฏ ูู ูููุฏ
- **ุณูููุฉ ุงูุตูุงูุฉ**: ูุง ุชูุฌุฏ ุฌุฏุงูู ุฅุถุงููุฉ ุฃู ููุทู ูุนูุฏ

### ๐ง ุขููุฉ ุงูุนูู:
1. ุงููุธุงู ูุฌูุจ ุงูููุงุชูุฑ ูู ูููุฏ
2. ูุจุญุซ ุนู ุฃุนูู ุฑูู ุจุตูุบุฉ INVXXXX
3. ูููุฏ ุงูุฑูู ุงูุชุงูู (ูุซู INV0005 ุจุนุฏ INV0004)
4. ูุฑุณู ุงููุงุชูุฑุฉ ุงูุฌุฏูุฏุฉ ุฅูู ูููุฏ

### ๐ก๏ธ ุขููุฉ ุงูุฃูุงู:
- **Fallback mechanism**: ูู ุญุงูุฉ ูุดู ูููุฏุ ูุณุชุฎุฏู timestamp
- **ุงูุชุญูู ูู ุงูุตูุบุฉ**: ูุชุฃูุฏ ูู ุฃู ุงูุฑูู ุจุตูุบุฉ INVXXXX ุงูุตุญูุญุฉ
- **Logging ุดุงูู**: ุชุณุฌูู ุฌููุน ุงูุนูููุงุช ูููุชุงุจุนุฉ

## ๐ฏ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ
ุงููุธุงู ุงูุขู ูุนูู ุจุงููุงูู ูุน ูููุฏ ููุถูู:
- **ุชุณูุณู ุตุญูุญ** ููููุงุชูุฑ ุจุตูุบุฉ INVXXXX
- **ุนุฏู ุชูุฑุงุฑ** ุงูุฃุฑูุงู ุนุจุฑ ุงูุจูุฆุงุช ุงููุฎุชููุฉ
- **ููุซูููุฉ ุนุงููุฉ** ุจุงุณุชุฎุฏุงู ูููุฏ ููุตุฏุฑ ูุญูุฏ ููุญูููุฉ
